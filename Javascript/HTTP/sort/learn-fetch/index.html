<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Learn Fetch &amp; Promises</title>
    <link
      rel="preload"
      href="/assets/fonts/GT-Eesti-Text-Light-subset.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link rel="icon" href="/assets/favicon.svg" />
    <link href="/assets/css/styles.css" rel="stylesheet" />
  </head>
  <body>
    <div>
      <header class="hstack jc-between pad-lg">
        <a href="/" aria-label="Home"
          ><img src="/assets/images/logo.svg" width="100" alt
        /></a>
        <nav id="global-nav">
          <ul role="list" class="hstack">
            <li>
              <a class="global-nav__link" href="/course/introduction/"
                >Course</a
              >
            </li>
            <li>
              <a class="global-nav__link" href="/resources/introduction/"
                >Resources</a
              >
            </li>
            <li><a class="global-nav__link" href="/about/">About</a></li>
          </ul>
        </nav>
      </header>
      <div class="center">
        <div class="layout">
          <aside></aside>
          <main id="main">
            <div>
              <header class="vstack gap-xl pad-xl stripes">
                <div class="vstack" data-gap="md">
                  <h1 class="highlight bg-primary">
                    Learn Fetch &amp; Promises
                  </h1>
                  <p class="highlight fz-lg">
                    Learn how promises make asynchronous JS easier to manage,
                    then make HTTP requests using the fetch method
                  </p>
                  <ul role="list" class="hstack gap-sm wrap">
                    <li
                      class="highlight fz-sm fw-bold"
                      style="--bg: var(--bg-400)"
                    >
                      js
                    </li>
                    <li
                      class="highlight fz-sm fw-bold"
                      style="--bg: var(--bg-400)"
                    >
                      promises
                    </li>
                    <li
                      class="highlight fz-sm fw-bold"
                      style="--bg: var(--bg-400)"
                    >
                      fetch
                    </li>
                  </ul>
                </div>
                <div class="hstack wrap">
                  <div class="vstack gap-none">
                    <label
                      for="download-command"
                      class="highlight fw-bold"
                      style="--bg: var(--bg-400)"
                      >Download files via CLI</label
                    ><copy-text class="hstack gap-none ai-stretch"
                      ><input
                        id="download-command"
                        readonly
                        value="npx degit 'foundersandcoders/coursebook/src/workshops/learn-fetch/starter-files#main' learn-fetch" /><button
                        aria-label="Copy"
                        title="Copy"
                        hidden
                      >
                        <svg
                          data-copy
                          width="20"
                          height="20"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke="currentColor"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                          ></path></svg
                        ><svg
                          hidden
                          data-success
                          width="20"
                          height="20"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke="currentColor"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M5 13l4 4L19 7"
                          ></path>
                        </svg></button
                    ></copy-text>
                  </div>
                  <a
                    href="https://github.com/foundersandcoders/coursebook/issues/new?title=%5Bworkshops%2Flearn-fetch%5D&amp;labels=feedback"
                    target="_blank"
                    rel="noopener"
                    class="button"
                    >Leave feedback<svg
                      viewBox="0 0 20 20"
                      fill="currentColor"
                      width="16"
                      height="16"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M10 2c-2.236 0-4.43.18-6.57.524C1.993 2.755 1 4.014 1 5.426v5.148c0 1.413.993 2.67 2.43 2.902 1.168.188 2.352.327 3.55.414.28.02.521.18.642.413l1.713 3.293a.75.75 0 001.33 0l1.713-3.293a.783.783 0 01.642-.413 41.102 41.102 0 003.55-.414c1.437-.231 2.43-1.49 2.43-2.902V5.426c0-1.413-.993-2.67-2.43-2.902A41.289 41.289 0 0010 2zM6.75 6a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5zm0 2.5a.75.75 0 000 1.5h3.5a.75.75 0 000-1.5h-3.5z"
                        clip-rule="evenodd"
                      ></path></svg
                  ></a>
                </div>
              </header>
              <div style="margin: 4rem 0" class="flow">
                <p>
                  We’re going to learn how to make HTTP requests in JavaScript.
                  This is made possible by the <code>fetch</code> function,
                  which uses something called “promises” to manage async code.
                  Here’s a really quick example of what it looks like before we
                  dive in:
                </p>
                <pre
                  class="language-js"
                ><code class="language-js"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://pokeapi.co/api/v2/pokemon/pikachu"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                <h2 id="asynchronicity">
                  Asynchronicity
                  <a class="heading-anchor" href="#asynchronicity">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h2>
                <p>
                  Before we look at promises, lets make sure we understand what
                  problem they solve.
                </p>
                <p>
                  JavaScript is a single-threaded language. This means things
                  generally happen one at a time, in the order you wrote the
                  code.
                </p>
                <pre
                  class="language-javascript"
                ><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token comment">// logs 1, then 2, then 3</span></code></pre>
                <p>
                  When something needs to happen out of this order, we call it
                  <em>asynchronous</em>. JavaScript handles this using a
                  “queue”. Anything asynchronous gets pushed out of the main
                  running order and into the queue. Once JS finishes what it was
                  doing it moves on to the first thing in the queue.
                </p>
                <pre
                  class="language-javascript"
                ><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                <p>
                  This code logs <code>1</code>, then <code>3</code>, then
                  (after 1 second) logs <code>2</code>.
                </p>
                <p>
                  It’s intuitive that the above example logs
                  <code>2</code> last, because JS has to wait a whole second
                  before running the function passed to <code>setTimeout</code>.
                </p>
                <p>
                  What’s less intuitive is that this is the same even with a
                  timeout of 0ms.
                </p>
                <pre
                  class="language-javascript"
                ><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                <p>
                  This code logs <code>1</code>, then <code>3</code>, then (as
                  soon as possible) logs <code>2</code>.
                </p>
                <p>
                  This is because <code>setTimeout</code> always gets pushed to
                  the back of the queue—the specified wait time just tells JS
                  the <em>minimum time</em> that has to pass before that code is
                  allowed to run.
                </p>
                <h2 id="callbacks">
                  Callbacks
                  <a class="heading-anchor" href="#callbacks">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h2>
                <p>
                  We can use callbacks (functions passed as arguments to other
                  functions) to access async values or run our code once some
                  async task completes. In fact the first argument to
                  <code>setTimeout</code> above is a callback. We pass a
                  function which <code>setTimeout</code> runs once the timeout
                  has finished.
                </p>
                <p>
                  Callbacks can be fiddly to deal with, and you can end up with
                  very nested function calls if you have to chain lots of async
                  stuff. Here’s a contrived example:
                </p>
                <pre
                  class="language-js"
                ><code class="language-js"><span class="token function">getStuff</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">stuff</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token function">getOtherStuff</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">otherStuff</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token function">getThirdStuff</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">thirdStuff</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token function">getEvenMoreStuff</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">finalStuff</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>finalStuff<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                <p>
                  This is often referred to as “callback hell”. In more
                  realistic code with error handling etc it can be pretty hard
                  to follow.
                </p>
                <p>
                  Here’s how that would look if each function returned a promise
                  instead:
                </p>
                <pre
                  class="language-js"
                ><code class="language-js"><span class="token function">getStuff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>getOtherStuff<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>getThirdStuff<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>getEvenMoreStuff<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                <p>
                  Our code stays “flat” at the same level no matter how many
                  async things happen.
                </p>
                <h2 id="what-is-a-promise">
                  What is a promise?
                  <a class="heading-anchor" href="#what-is-a-promise">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h2>
                <p>
                  Promises are a special type of object. They allow us to
                  represent the <em>eventual result</em> of async code. A
                  function that executes asynchronously can return a promise
                  object instead of the final value (which it doesn’t have yet).
                </p>
                <p>
                  For example when we fetch some data from a server we will
                  receive a <em>promise</em> that will eventually represent the
                  server’s response (when the network request completes).
                </p>
                <h2 id="using-fetch">
                  Using <code>fetch</code>
                  <a class="heading-anchor" href="#using-fetch">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h2>
                <p>
                  We can use the global <code>fetch</code> function to make HTTP
                  requests in the browser. It takes two arguments: the URL you
                  want to send the request to and an options object (we’ll look
                  at that later). It returns a promise object that will
                  eventually contain the response.
                </p>
                <h3 id="challenge-1">
                  Challenge 1
                  <a class="heading-anchor" href="#challenge-1">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h3>
                <ol>
                  <li>
                    Open <code>starter-files/workshop.html</code> in your
                    editor. Add your code inside the script tag.
                  </li>
                  <li>
                    Use <code>fetch</code> to make a request to
                    <code
                      >&quot;https://pokeapi.co/api/v2/pokemon/pikachu&quot;</code
                    >.
                  </li>
                  <li>Assign the return value to a variable and log it.</li>
                  <li>
                    Open the file in your browser. You should see the pending
                    promise in the console.
                  </li>
                </ol>
                <p>
                  <img
                    src="https://user-images.githubusercontent.com/9408641/74358318-2dbef800-4db9-11ea-903d-63f0530bcffa.png"
                    alt=""
                  />
                </p>
                <div class="box box-success content">
                  <details class="disclosure flow">
                    <summary>Toggle answer</summary>
                    <pre
                      class="language-js"
                    ><code class="language-js"><span class="token keyword">const</span> pokePromise <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://pokeapi.co/api/v2/pokemon/pikachu"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pokePromise<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                  </details>
                </div>
                <h3 id="promise-terminology">
                  Promise terminology
                  <a class="heading-anchor" href="#promise-terminology">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h3>
                <p>Promises can be in 3 states:</p>
                <ol>
                  <li><em>pending</em> (async code has not finished yet)</li>
                  <li><em>fulfilled</em> (expected value is available)</li>
                  <li>
                    <em>rejected</em> (expected value is
                    <em>not</em> available).
                  </li>
                </ol>
                <p>
                  There’s a bit more complexity to this, so it’s worth reading
                  this
                  <a
                    href="https://github.com/domenic/promises-unwrapping/blob/master/docs/states-and-fates.md"
                    >explanation of promise states</a
                  >
                  later.
                </p>
                <pre
                  class="language-javascript"
                ><code class="language-javascript"><span class="token keyword">const</span> myPromise <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myPromise<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token comment">// Promise { &lt;state>: "pending" }</span><br><span class="token comment">// or</span><br><span class="token comment">// Promise { &lt;state>: "fulfilled", &lt;value>: theResult }</span><br><span class="token comment">// or</span><br><span class="token comment">// Promise { &lt;state>: "rejected", &lt;value>: Error }</span><br><span class="token comment">// Note: different browsers may show promises differently in the console</span></code></pre>
                <p>
                  So how do we actually access the value when the promise
                  fulfills?
                </p>
                <h2 id="accessing-the-promise-value">
                  Accessing the promise value
                  <a class="heading-anchor" href="#accessing-the-promise-value">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h2>
                <p>
                  Since the promise’s fulfilled value isn’t accessible
                  synchronously, we can’t use it immediately like a normal JS
                  variable. We need a way to tell JS to run our code once the
                  promise has fulfilled.
                </p>
                <pre
                  class="language-javascript"
                ><code class="language-javascript"><span class="token keyword">const</span> myPromise <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>myPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                <p>
                  Promises are objects with a <code>.then()</code> method. This
                  method takes a callback function as an argument. The promise
                  will call this function with the fulfilled value when it’s
                  ready.
                </p>
                <p>
                  It’s worth noting that you don’t need to keep the promise
                  itself around as a variable.
                </p>
                <pre
                  class="language-javascript"
                ><code class="language-javascript"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                <h3 id="challenge-2">
                  Challenge 2
                  <a class="heading-anchor" href="#challenge-2">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h3>
                <ol>
                  <li>
                    Use <code>.then()</code> to access the result of your
                    PokéAPI request. Log this to see what a JS response object
                    looks like.
                  </li>
                </ol>
                <p>
                  <img
                    src="https://user-images.githubusercontent.com/9408641/74358327-31527f00-4db9-11ea-873d-30865128b313.png"
                    alt=""
                  />
                </p>
                <div class="box box-success content">
                  <details class="disclosure flow">
                    <summary>Toggle answer</summary>
                    <pre
                      class="language-js"
                    ><code class="language-js"><span class="token keyword">const</span> pokePromise <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://pokeapi.co/api/v2/pokemon/pikachu"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>pokePromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                  </details>
                </div>
                <h2 id="accessing-the-response-body">
                  Accessing the response body
                  <a class="heading-anchor" href="#accessing-the-response-body">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h2>
                <p>
                  The promise resolves with an object representing the HTTP
                  response (e.g. it has a <code>status</code> property). However
                  since the response body could be in many different formats
                  there’s an extra step to access it. Response objects have
                  built-in methods for parsing different body formats.
                </p>
                <p>
                  Since the PokéAPI returns JSON-formatted data we can use the
                  <code>response.json()</code> method to access it. Accessing
                  the body can be slow, so this is async too. The
                  <code>.json()</code> method also returns a promise, so we need
                  to use another <code>.then()</code> to access the value.
                </p>
                <pre
                  class="language-js"
                ><code class="language-js"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                <p>
                  Nesting our <code>.then()</code>s like this is getting us back
                  into the same mess as with callbacks. Luckily promises have a
                  nice solution to this problem.
                </p>
                <h4 id="chaining-thens">
                  Chaining <code>.then</code>s
                  <a class="heading-anchor" href="#chaining-thens">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h4>
                <p>
                  The <code>.then()</code> method always returns a promise,
                  which will resolve to whatever value you return from your
                  callback. This allows you to chain your <code>.then()</code>s
                  and avoid nested callback hell.
                </p>
                <p>
                  The <code>.then</code>s will run in order, and wait for the
                  previous one to fulfill before starting. Here our first
                  <code>.then</code> returns the promise that the
                  <code>response.json()</code> method creates. Our second
                  <code>.then</code> only runs once that promise fulfills with
                  the JSON data.
                </p>
                <pre
                  class="language-js"
                ><code class="language-js"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=></span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                <h3 id="challenge-3">
                  Challenge 3
                  <a class="heading-anchor" href="#challenge-3">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h3>
                <ol>
                  <li>
                    Use <code>response.json()</code> to get the response body
                  </li>
                  <li>
                    Add another <code>.then()</code> to log the body. You should
                    see a Pokémon object
                  </li>
                </ol>
                <p>
                  <img
                    src="https://user-images.githubusercontent.com/9408641/74358336-34e60600-4db9-11ea-8394-e6df57e3cef2.png"
                    alt=""
                  />
                </p>
                <div class="box box-success content">
                  <details class="disclosure flow">
                    <summary>Toggle answer</summary>
                    <pre
                      class="language-js"
                    ><code class="language-js"><span class="token keyword">const</span> pokePromise <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://pokeapi.co/api/v2/pokemon/pikachu"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>pokePromise<br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=></span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pikachu</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pikachu<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                  </details>
                </div>
                <h2 id="handling-errors">
                  Handling errors
                  <a class="heading-anchor" href="#handling-errors">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h2>
                <p>
                  Sometimes requests go wrong. Promises have a built in way to
                  control what happens when the asynchronous code hits an error.
                  We can pass a function to the promise’s
                  <code>.catch()</code> method. This will be run
                  <em>instead of</em> the <code>.then()</code> if the promise
                  rejects. Your callback will be passed the error that occurred
                  instead of the data you wanted.
                </p>
                <pre
                  class="language-javascript"
                ><code class="language-javascript"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"broken-url"</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                <h3 id="challenge-4">
                  Challenge 4
                  <a class="heading-anchor" href="#challenge-4">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h3>
                <ol>
                  <li>
                    Remove the URL from your fetch call. You should see the
                    browser warn you about an “uncaught error”
                  </li>
                  <li>
                    Add a <code>.catch()</code> to your code that logs the error
                    instead
                  </li>
                </ol>
                <p>
                  Note: you would usually want to do something useful with the
                  error instead of just logging it.
                </p>
                <p>
                  <img
                    src="https://user-images.githubusercontent.com/9408641/74358484-6959c200-4db9-11ea-98a0-7cb2ba107908.png"
                    alt=""
                  />
                </p>
                <div class="box box-success content">
                  <details class="disclosure flow">
                    <summary>Toggle answer</summary>
                    <pre
                      class="language-js"
                    ><code class="language-js"><span class="token keyword">const</span> pokePromise <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>pokePromise<br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=></span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pikachu</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pikachu<span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                  </details>
                </div>
                <hr />
                <h2 id="workshop">
                  Workshop
                  <a class="heading-anchor" href="#workshop">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h2>
                <p>
                  We’re going to use the <code>fetch</code> function to get a
                  user from the GitHub API. The API is free to access, but you
                  might get rate-limited if you make too many requests. If you
                  hit this problem you can fix it by
                  <a href="https://github.com/settings/tokens"
                    >generating an access token</a
                  >
                  and including it in the request URL.
                </p>
                <h3 id="task-1">
                  Task 1
                  <a class="heading-anchor" href="#task-1">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h3>
                <ol>
                  <li>
                    Write a <code>getUser</code> function that takes a username
                    argument
                  </li>
                  <li>
                    It should fetch that user’s profile from
                    <code
                      >&quot;https://api.github.com/users/USERNAME_HERE&quot;</code
                    >
                  </li>
                  <li>
                    It should be callable like this:
                    <pre
                      class="language-js"
                    ><code class="language-js"><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token string">"oliverjam"</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
                  </li>
                </ol>
                <p>
                  <img
                    src="https://user-images.githubusercontent.com/9408641/74358494-6bbc1c00-4db9-11ea-9abe-687aa5a574f1.png"
                    alt=""
                  />
                </p>
                <h3 id="task-2">
                  Task 2
                  <a class="heading-anchor" href="#task-2">
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h3>
                <ol>
                  <li>
                    Write a <code>getRepos</code> function that takes the Github
                    user response object as an argument.
                  </li>
                  <li>
                    Fetch the a user using <code>getUser</code>,
                    <em>then</em> use <code>getRepos</code> to fetch their repos
                    using the <code>repos_url</code> property from the user
                    object.
                  </li>
                  <li>Log the array of repos.</li>
                </ol>
                <p>
                  <img
                    src="https://user-images.githubusercontent.com/9408641/74358501-6eb70c80-4db9-11ea-95f8-69264ed3585c.png"
                    alt=""
                  />
                </p>
                <h3 id="bonus-if-you-have-time-task-3">
                  Bonus if you have time: Task 3
                  <a
                    class="heading-anchor"
                    href="#bonus-if-you-have-time-task-3"
                  >
                    <svg
                      viewBox="0 0 32 32"
                      width="20"
                      height="20"
                      fill="none"
                      stroke="currentcolor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                    >
                      <path
                        d="M18 8 C18 8 24 2 27 5 30 8 29 12 24 16 19 20 16 21 14 17 M14 24 C14 24 8 30 5 27 2 24 3 20 8 16 13 12 16 11 18 15"
                      ></path>
                    </svg>
                  </a>
                </h3>
                <ol>
                  <li>
                    Fetch multiple GitHub profiles <em>simultaneously</em> using
                    your <code>getUser</code> function above (you’ll have to
                    call it more than once)
                  </li>
                </ol>
                <p>
                  You might want to read the docs for
                  <a
                    href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all"
                    ><code>Promise.all</code></a
                  >
                </p>
                <p>
                  <img
                    src="https://user-images.githubusercontent.com/9408641/74358510-7080d000-4db9-11ea-8cf9-63d15b78a618.png"
                    alt=""
                  />
                </p>
              </div>
            </div>
          </main>
        </div>
      </div>
    </div>
    <script type="module" src="/assets/js/checkboxen.js"></script>
    <script src="/assets/js/toggle-button.js"></script>
    <script src="/assets/js/copy-text.js"></script>
  </body>
</html>
